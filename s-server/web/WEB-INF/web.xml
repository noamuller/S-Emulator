<?xml version="1.0" encoding="UTF-8"?>
<web-app
        xmlns="https://jakarta.ee/xml/ns/jakartaee"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_5_0.xsd"
        version="5.0">

    <!-- ===== Context-wide init ===== -->
    <display-name>s-server</display-name>

    <!-- If your container is not scanning annotations, make sure we init the facade -->
    <listener>
        <listener-class>server.api.Bootstrap</listener-class>
    </listener>

    <!-- ===== Programs ===== -->
    <servlet>
        <servlet-name>UploadProgramServlet</servlet-name>
        <servlet-class>server.api.UploadProgramServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>UploadProgramServlet</servlet-name>
        <url-pattern>/api/programs/upload</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>ProgramExpandServlet</servlet-name>
        <servlet-class>server.api.ProgramExpandServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>ProgramExpandServlet</servlet-name>
        <url-pattern>/api/programs/expand</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>ListProgramsServlet</servlet-name>
        <servlet-class>server.api.ListProgramsServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>ListProgramsServlet</servlet-name>
        <url-pattern>/api/programs</url-pattern>
    </servlet-mapping>

    <!-- ===== Runs (regular + debug) ===== -->
    <servlet>
        <servlet-name>StartRunServlet</servlet-name>
        <servlet-class>server.api.StartRunServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>StartRunServlet</servlet-name>
        <url-pattern>/api/runs/start</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>RunStatusServlet</servlet-name>
        <servlet-class>server.api.RunStatusServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>RunStatusServlet</servlet-name>
        <url-pattern>/api/runs/status</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>RunStepServlet</servlet-name>
        <servlet-class>server.api.RunStepServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>RunStepServlet</servlet-name>
        <url-pattern>/api/debug/step</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>RunResumeServlet</servlet-name>
        <servlet-class>server.api.RunResumeServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>RunResumeServlet</servlet-name>
        <url-pattern>/api/debug/resume</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>RunStopServlet</servlet-name>
        <servlet-class>server.api.RunStopServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>RunStopServlet</servlet-name>
        <url-pattern>/api/debug/stop</url-pattern>
    </servlet-mapping>

    <!-- ===== Auth / Users / Credits ===== -->
    <servlet>
        <servlet-name>LoginServlet</servlet-name>
        <servlet-class>server.api.LoginServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>LoginServlet</servlet-name>
        <url-pattern>/api/login</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>MeServlet</servlet-name>
        <servlet-class>server.api.MeServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>MeServlet</servlet-name>
        <url-pattern>/api/me</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>ChargeCreditsServlet</servlet-name>
        <servlet-class>server.api.ChargeCreditsServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>ChargeCreditsServlet</servlet-name>
        <url-pattern>/api/credits/charge</url-pattern>
    </servlet-mapping>

    <!-- Optional hello ping -->
    <servlet>
        <servlet-name>HelloServlet</servlet-name>
        <servlet-class>server.api.HelloServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>HelloServlet</servlet-name>
        <url-pattern>/api/hello</url-pattern>
    </servlet-mapping>

</web-app>
